<!DOCTYPE html>
<html>

<head>
    <title>Glitter</title>
    <style>
        body {
            margin: 0;
        }
    </style>
</head>

<body>
    <script src="js/three.js"></script>
    <script>
        var scene = new THREE.Scene();
        var frontSpot = new THREE.SpotLight(0xeeeece);
        frontSpot.position.set(1000, 1000, 1000);
        scene.add(frontSpot);
        var frontSpot2 = new THREE.SpotLight(0xddddce);
        frontSpot2.position.set(-300, -300, -300);
        scene.add(frontSpot2);
        var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);

        var renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        var geometry = new THREE.CircleGeometry(0.1, 32);

        let pailletteArray = [];
        for (var k = 0; k < 100; k = k + 6) {
            for (var j = 0; j < 100; j = j + 9) {
                for (var i = 0; i < 100; i = i + 4) {
                    var material = new THREE.MeshPhongMaterial({
                        color: createRandomColor(),
                        specular: createRandomColor(),
                    });
                    var object = new THREE.Mesh(geometry, material);
                    object.position.x = i;
                    object.position.y = j;
                    object.position.z = k;
                    pailletteArray.push(object);
                    scene.add(object);

                }
            }
        }
        render();

        camera.position.z = 25;
        
        function render() {
            requestAnimationFrame(render)
            for (var u = 0; u < pailletteArray.length; u++) {
                let random = Math.floor(Math.random() * Math.floor(2));


                if (random === 0) {
                    pailletteArray[u].position.x -= Math.random() * 0.1;
                }
                if (random === 1) {
                    pailletteArray[u].position.y -= Math.random() * 0.03;
                }
                if (random === 2) {
                    pailletteArray[u].position.z -= Math.random() * 0.1;
                }


                pailletteArray[u].rotation.x += 0.11;
                pailletteArray[u].rotation.y += 0.11;
                pailletteArray[u].rotation.z += 0.11;
            }


            renderer.render(scene, camera);


            var frustum = new THREE.Frustum();
            var cameraViewProjectionMatrix = new THREE.Matrix4();

            var ob =  pailletteArray[10];

            camera.updateMatrixWorld();  
            camera.matrixWorldInverse.copy( camera.matrixWorld ).invert();
            cameraViewProjectionMatrix.multiplyMatrices(camera.projectionMatrix, camera.matrixWorldInverse);
            frustum.setFromProjectionMatrix(cameraViewProjectionMatrix);

            

            console.log(frustum.intersectsObject( ob ));
        }

        function createRandomColor() {
            return Math.floor(Math.random() * 16777215);
        }

    </script>
</body>

</html>